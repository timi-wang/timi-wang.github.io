<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
    <link href="https://cdn.jsdelivr.net/gh/timi-wang/timi-wang.github.io/favicon.ico" rel="shortcut icon">
    <style>
        @font-face{font-family:'Avenir Next';font-style:normal;font-weight:400;src:local('Avenir Next Thin'),local("AvenirNext-Thin"),url(https://cdn.jsdelivr.net/gh/timi-wang/timi-wang.github.io/fonts/full/AvenirNextThin.ttf);}
        @font-face{font-family:'Lora';font-weight:400;src:local('Lora Italic'),url(https://cdn.jsdelivr.net/gh/timi-wang/timi-wang.github.io/fonts/full/Lora-Italic.ttf)}
        @font-face{font-family:'Baskerville';font-weight:400;src:local('Baskerville Italic'),url(https://cdn.jsdelivr.net/gh/timi-wang/timi-wang.github.io/fonts/full/Baskerville-Italic.ttf)}
        @font-face{font-family:'HYQiHei';font-style:normal;font-weight:400;src:local('HYQiHei'),url(https://cdn.jsdelivr.net/gh/timi-wang/timi-wang.github.io/fonts/subset/HYQiHei-35S.ttf)}
        @font-face{font-family:'HYKaiTiS';font-weight:400;src:local('HYKaiTiS'),url(https://cdn.jsdelivr.net/gh/timi-wang/timi-wang.github.io/fonts/subset/HYKaiTiS.ttf)}
        @font-face{font-family:'HYFangSongS';font-weight:400;src:local('HYFangSongS'),url(https://cdn.jsdelivr.net/gh/timi-wang/timi-wang.github.io/fonts/subset/HYFangSongS.ttf)}
    </style>
    
    <link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.0.1/styles/github.min.css"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.0.1/highlight.min.js"></script>
    

    

    <link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/gh/timi-wang/timi-wang.github.io/common/base.css"/>
</head>
<body class="light">
<main>
    <header id="common-header">
        <style>
    #common-header {
        display: flex;
        flex-flow: row nowrap;
        justify-content: space-between;
        align-items: center;
    }
    #common-header>.menu {
        display: flex;
        flex-flow: row nowrap;
        list-style: none;
    }
    #common-header>.menu>a {
        opacity: .5;
        font-size: 14px;
        transition: all .5s;
        text-decoration: none;
        display: inline;
    }
    #common-header>.menu>a:hover {
        opacity: 1;
    }
    #common-header>.menu>a:before {
        content: 'Â·';
        padding: 0 8px;
        color: var(--text);
    }
    #common-header>.menu>a:first-child:before {
        display: none;
    }
</style>
<a href="/" title="Home"><img src="https://cdn.jsdelivr.net/gh/timi-wang/timi-wang.github.io/common/logo.png" style="width:48px"></a>
<span class="menu">
    <a href="/articles" title="articles">Articles</a>
    <a href="/blog" title="blog">Blog</a>
    <a href="/about" title="about">About</a>
</span>


    </header>
    <article id="article">
        <header id="article-header">
            <h1>æµ‹è¯•</h1>
            <p class="extra-data">2021.7.11</p>
        </header>
        <div id="article-content">
            
      <h2 id="kubernetes%E5%85%A5%E9%97%A8%E7%BA%A7%E5%88%AB%E7%9A%84%E6%96%B0%E6%89%8B%E5%BC%95%E5%AF%BC%E3%80%82">
        <a aria-hidden="true" class="anchor" href="#kubernetes%E5%85%A5%E9%97%A8%E7%BA%A7%E5%88%AB%E7%9A%84%E6%96%B0%E6%89%8B%E5%BC%95%E5%AF%BC%E3%80%82">
            <svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>
        </a>
        kuberneteså…¥é—¨çº§åˆ«çš„æ–°æ‰‹å¼•å¯¼ã€‚
      </h2>
    <p><img src="https://cdn.jsdelivr.net/gh/timi-wang/timi-wang.github.io//blog/2021/æµ‹è¯•/klee.jpeg" alt=""/></p>
<p>
          <figure>
              <img src="https://cdn.jsdelivr.net/gh/timi-wang/timi-wang.github.io//blog/2021/æµ‹è¯•/klee.jpeg" alt="Paul Klee - Color Chart (1931) å…¥é—¨çº§åˆ«çš„æ–°æ‰‹å¼•å¯¼">
              <figcaption>Paul Klee - Color Chart (1931) å…¥é—¨çº§åˆ«çš„æ–°æ‰‹å¼•å¯¼</figcaption>
          </figure>
        </p>

      <h2 id="%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5">
        <a aria-hidden="true" class="anchor" href="#%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5">
            <svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>
        </a>
        åŸºç¡€æ¦‚å¿µ
      </h2>
    <div class="callout orange">
          <span class="emoji">ğŸ˜€</span>
          <p>this is a  test<br>test2<br>fdas</p>

        </div><blockquote>
<p>Dorothy followed her through many of the beautiful rooms in her castle.</p>
</blockquote>
<blockquote>
<p>ç®€è€Œè¨€ä¹‹æ˜¯ä¸€ä¸ªå®¹å™¨ç®¡ç†ç³»ç»Ÿï¼Œå¼€æºï¼Œè°·æ­ŒèƒŒä¹¦</p>
</blockquote>
<ul>
<li><strong>Kubernetes Master</strong>æ˜¯ä¸‰ä¸ªè·‘åœ¨åŒä¸€èŠ‚ç‚¹çš„æ ¸å¿ƒè¿›ç¨‹çš„æ€»ç§°ï¼š<ul>
<li><a href="https://kubernetes.io/docs/admin/kube-apiserver/">kube-apiserver</a>ï¼šæä¾›å¯¹å¤–kubernetes apiæ¥å£</li>
<li><a href="https://kubernetes.io/docs/admin/kube-controller-manager/">kube-controller-manager</a>ï¼šæ˜¯ä¸€ç¾¤æ§åˆ¶å™¨çš„æ€»ç§°ï¼š<ul>
<li><code>node controller</code>: å‘ç°æ–°èŠ‚ç‚¹åŠç›‘æ§æŒ‚æ‰çš„èŠ‚ç‚¹</li>
<li><em>replication controller</em>: ç»´æŠ¤ç¡®ä¿podsæ•°é‡æ­£ç¡®</li>
<li><strong>endpoints controller</strong>: ç»‘å®šserviceså’Œpods</li>
<li>service account &amp; token controller: ä¸ºæ–°çš„namespaceåˆ›å»ºé»˜è®¤è´¦å·åŠapiè®¿é—®token</li>
</ul>
</li>
<li><a href="https://kubernetes.io/docs/admin/kube-scheduler/">kube-scheduler</a>ï¼šè´Ÿè´£podsä¸nodesçš„åˆç†è°ƒåº¦åˆ†é…</li>
</ul>
</li>
<li>å…¶ä»–émasterèŠ‚ç‚¹ä¸Šä¼šè·‘ä¸¤ä¸ªè¿›ç¨‹ï¼š<ul>
<li><a href="https://kubernetes.io/docs/admin/kubelet/">kubelet</a>ï¼šè´Ÿè´£ä¸masteré€šä¿¡</li>
<li><a href="https://kubernetes.io/docs/admin/kube-proxy/">kube-proxy</a>ï¼šè´Ÿè´£èŠ‚ç‚¹é—´çš„ç½‘ç»œä»£ç†</li>
</ul>
</li>
</ul>
<p>åŸºæœ¬kuberneteså¯¹è±¡ï¼špod, service, volume, namespace<br>é«˜çº§kuberneteså¯¹è±¡ï¼šreplicaSet, deployment, statefulSet, daemonSet, job</p>
<p>ä¸€äº›é™„åŠ ç»„ä»¶ï¼š</p>
<ul>
<li>DNS: clusterå†…éƒ¨çš„dnsè§£æç³»ç»Ÿ</li>
<li>web ui: webçš„æ§åˆ¶ç•Œé¢</li>
<li>container resource monitoring: èµ„æºç›‘æ§</li>
<li>cluster-level logging: è´Ÿè´£å°†containerçš„logä¿å­˜åˆ°ç‰¹å®šçš„log store</li>
</ul>

      <h2 id="%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAcluster">
        <a aria-hidden="true" class="anchor" href="#%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAcluster">
            <svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>
        </a>
        åˆ›å»ºä¸€ä¸ªcluster
      </h2>
    <p>kubernetesç®€è€Œè¨€ä¹‹æ˜¯ä¸€ä¸ªå®¹å™¨ç®¡ç†ç³»ç»Ÿï¼Œå¼€æºï¼Œè°·æ­ŒèƒŒä¹¦ã€‚</p>
<p>æ¶æ„ä¸ŠåŒ…å«masterå’Œnodeï¼Œæ¯ä¸ªnodeå¯ä»¥è§†ä¸ºä¸€å°æœåŠ¡å™¨æˆ–ECSï¼Œnodeä¸Šå¯ä»¥è·‘å¤šä¸ªprocessï¼Œmasterç®¡ç†nodeã€‚ä¸€ä¸ªçº¿ä¸Šç¯å¢ƒkubernetesé›†ç¾¤æœ€å°‘åº”æœ‰ä¸‰ä¸ªnodesã€‚</p>
<p><a href="https://github.com/kubernetes/minikube">Minikube</a>æ˜¯kubernetesçš„ä¸€ä¸ªå…·ä½“å®ç°ï¼Œå¯åœ¨æœ¬åœ°åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿæœºï¼Œæ¨¡æ‹Ÿä¸€ä¸ªç®€å•é›†ç¾¤ã€‚</p>
<p>minikubeæœ‰å…³å‘½ä»¤ï¼š</p>
<pre><code class="language-bash hljs">$ minikube start              // å¯åŠ¨é›†ç¾¤
$ kubectl cluster-info          // æ˜¾ç¤ºé›†ç¾¤ä¿¡æ¯ï¼Œä¼šæ˜¾ç¤ºmasterçš„ç®¡ç†ç•Œé¢url
$ kubectl get nodes             // æ˜¾ç¤ºæ‰€æœ‰èŠ‚ç‚¹ä¿¡æ¯</code></pre>
      <h2 id="%E9%83%A8%E7%BD%B2%E5%BA%94%E7%94%A8">
        <a aria-hidden="true" class="anchor" href="#%E9%83%A8%E7%BD%B2%E5%BA%94%E7%94%A8">
            <svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>
        </a>
        éƒ¨ç½²åº”ç”¨
      </h2>
    <p>æœ‰å…³å‘½ä»¤ï¼š</p>
<pre><code class="language-bash hljs">$ kubectl run [name] --image=[é•œåƒåœ°å€] --port=8080     // éƒ¨ç½²åº”ç”¨
$ kubectl get deployments               // è·å–æ‰€æœ‰deploymentsä¿¡æ¯
$ kubectl proxy // å¼€å¯clusterå†…éƒ¨çš„ç½‘ç»œä»£ç†ï¼Œè¿™æ ·å¯ä»¥ç›´æ¥ç”±å¤–éƒ¨urlè®¿é—®å†…éƒ¨api</code></pre><p>ç”¨<code>$ kubectl get pods</code>å¯ä»¥æ˜¾ç¤ºpodä¿¡æ¯ï¼Œç„¶åå¯ä»¥é€šè¿‡ä»£ç†çš„urlç›´æ¥è®¿é—®æˆ‘ä»¬éƒ¨ç½²çš„åº”ç”¨æ¥å£ã€‚</p>
<pre><code class="language-bash hljs">//  å°†podåç§°è®°åˆ°å…¨å±€å˜é‡é‡Œ
$ <span class="hljs-built_in">export</span> POD_NAME=$(kubectl get pods -o go-template --template <span class="hljs-string">&#x27;{{range .items}}{{.metadata.name}}{{&quot;\n&quot;}}{{end}}&#x27;</span>)
$ <span class="hljs-built_in">echo</span> Name of the Pod: <span class="hljs-variable">$POD_NAME</span>

// å‡è®¾kubectl proxyè¿”å›çš„æ˜¯http://localhost:8001
$ curl http://localhost:8001/version    // åŒ kubectl versionçš„client version

// è®¿é—®åº”ç”¨çš„api
$ curl http://localhost:8001/api/v1/proxy/namespaces/default/pods/<span class="hljs-variable">$POD_NAME</span>/</code></pre>
      <h2 id="%E6%9B%B4%E5%A4%9A%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BA%92">
        <a aria-hidden="true" class="anchor" href="#%E6%9B%B4%E5%A4%9A%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BA%92">
            <svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>
        </a>
        æ›´å¤šåº”ç”¨äº¤äº’
      </h2>
    <p><strong>Pod</strong>æ˜¯ä¸€ä¸ªåº”ç”¨çš„æœ€å°é€»è¾‘å•å…ƒé›†åˆï¼Œå¯ä»¥åŒ…æ‹¬å¤šä¸ªcontainerized appå’Œå¤šä¸ªvolumeï¼Œä¸€ä¸ªnodeä¸Šå¯ä»¥è·‘å¤šä¸ªpodï¼Œä»–ä»¬å…±äº«<strong>å­˜å‚¨(volumes)<strong>ï¼Œ</strong>ip</strong>ï¼Œ<strong>å¯åŠ¨è„šæœ¬</strong>ã€‚</p>
<p>
          <figure>
              <img src="https://d33wubrfki0l68.cloudfront.net/5cb72d407cbe2755e581b6de757e0d81760d5b86/a9df9/docs/tutorials/kubernetes-basics/public/images/module_03_nodes.svg" alt="d33wubrfki0l68">
              <figcaption>d33wubrfki0l68</figcaption>
          </figure>
        </p>
<p>æœ‰å…³å‘½ä»¤ï¼š</p>
<pre><code class="language-bash hljs">$ kubectl get pods          // è·å–podsä¿¡æ¯
$ kubectl describe pods     // æŸ¥çœ‹podsè¯¦æƒ…ï¼Œdescribeå‘½ä»¤ä¹Ÿå¯ç”¨äºnodeå’Œdeployments</code></pre><p>åº”ç”¨é‡Œè¾“å‡ºåˆ°consoleï¼ˆSTDOUTï¼‰ä¸­çš„å†…å®¹ä¼šè¢«è®°å½•åˆ°logä¸­ï¼Œå¯ä»¥é€šè¿‡<code>kubectl logs $POD_NAME</code>æŸ¥çœ‹ã€‚</p>
<p>ä½¿ç”¨<code>kubectl exec</code>å¯åœ¨containerä¸­æ‰§è¡Œä»£ç ï¼š</p>
<pre><code class="language-bash hljs">$ kubectl <span class="hljs-built_in">exec</span> <span class="hljs-variable">$POD_NAME</span> env  // è¾“å‡ºcontainerä¸­çš„ç¯å¢ƒå˜é‡
$ kubectl <span class="hljs-built_in">exec</span> -ti <span class="hljs-variable">$POD_NAME</span> bash // åœ¨containerä¸­å¯åŠ¨bash</code></pre>
      <h2 id="%E5%90%AF%E5%8A%A8%E6%9C%8D%E5%8A%A1%E6%9A%B4%E9%9C%B2%E5%BA%94%E7%94%A8%E6%8E%A5%E5%8F%A3">
        <a aria-hidden="true" class="anchor" href="#%E5%90%AF%E5%8A%A8%E6%9C%8D%E5%8A%A1%E6%9A%B4%E9%9C%B2%E5%BA%94%E7%94%A8%E6%8E%A5%E5%8F%A3">
            <svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>
        </a>
        å¯åŠ¨æœåŠ¡æš´éœ²åº”ç”¨æ¥å£
      </h2>
    <p>serviceè´Ÿè´£ç»´æŠ¤podsçš„ç”Ÿå‘½å‘¨æœŸï¼Œè´Ÿè´£ä¿æ´»åŠæš´éœ²å¯¹å¤–æ¥å£ã€‚å®ƒå®šä¹‰äº†ä¸€ç¾¤é€»è¾‘ç›¸å…³çš„podsåŠå®ƒä»¬çš„æ¥å…¥æ–¹å¼ï¼š</p>
<ul>
<li>ClusterIP(é»˜è®¤)ï¼šæš´éœ²ä¸€ä¸ªä»…ä¾›é›†ç¾¤å†…è®¿é—®çš„ip</li>
<li>NodePortï¼šæš´éœ²å¯¹å¤–å¯è®¿é—®çš„port,ipå°±æ˜¯nodeæœ¬èº«çš„ipï¼Œ<NodeIp>:<NodePort>ï¼Œæ˜¯clusterIpçš„çˆ¶ç±»</li>
<li>LoadBalancerï¼šåˆ›å»ºä¸€ä¸ªåŸºäºå½“å‰cloudçš„è´Ÿè½½å‡è¡¡å®ä¾‹ï¼Œæä¾›ä¸€ä¸ªå›ºå®šçš„å¯¹å¤–ipï¼ŒNodePortçš„çˆ¶ç±»</li>
<li>ExternalNameï¼šè¿”å›ä¸€ä¸ªcnameè®°å½•ï¼Œç›´æ¥ç”¨åç§°æš´éœ²å¯¹å¤–æ¥å£</li>
</ul>
<p>serviceç”¨æ ‡ç­¾å’Œé€‰æ‹©å™¨å»åŒ¹é…podsï¼š</p>
<p><img src="https://d33wubrfki0l68.cloudfront.net/b964c59cdc1979dd4e1904c25f43745564ef6bee/f3351/docs/tutorials/kubernetes-basics/public/images/module_04_labels.svg" alt=""/></p>
<p>æœ‰å…³å‘½ä»¤ï¼š</p>
<pre><code class="language-bash hljs">$ kubectl get services          // æŸ¥çœ‹æ‰€æœ‰æœåŠ¡
$ kubectl expose deployment/kubernetes-bootcamp --<span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;NodePort&quot;</span> --port 8080 // å¯åŠ¨service
$ kubectl describe services/kubernetes-bootcamp     // æŸ¥çœ‹serviceè¯¦æƒ…

// å°†nodeportå­˜å…¥ç¯å¢ƒå˜é‡
$ <span class="hljs-built_in">export</span> NODE_PORT=$(kubectl get services/kubernetes-bootcamp -o go-template=<span class="hljs-string">&#x27;{{(index .spec.ports 0).nodePort}}&#x27;</span>)
$ <span class="hljs-built_in">echo</span> NODE_PORT=<span class="hljs-variable">$NODE_PORT</span>

// æµ‹è¯•æ¥å£
$ curl $(minikube ip):<span class="hljs-variable">$NODE_PORT</span></code></pre><p>å¯ä»¥è‡ªå®šä¹‰æ ‡ç­¾ç­›é€‰podsæˆ–serviceï¼š</p>
<pre><code class="language-bash hljs">$ kubectl describe deployment           // å¯ä»¥çœ‹åˆ°æ ‡ç­¾åç§°
$ kubectl get pods -l run=kubernetes-bootcamp   // é€šè¿‡æ ‡ç­¾ç­›é€‰pods
$ kubectl get services -l run=kubernetes-bootcamp   //é€šè¿‡æ ‡ç­¾ç­›é€‰service

// å°†podåç§°å­˜å…¥ç¯å¢ƒå˜é‡
$ <span class="hljs-built_in">export</span> POD_NAME=$(kubectl get pods -o go-template --template <span class="hljs-string">&#x27;{{range .items}}{{.metadata.name}}{{&quot;\n&quot;}}{{end}}&#x27;</span>)
$ <span class="hljs-built_in">echo</span> Name of the Pod: <span class="hljs-variable">$POD_NAME</span>

$ kubectl label pod <span class="hljs-variable">$POD_NAME</span> app=v1    // å°†podçš„labelæ”¹ä¸ºapp=v1
$ kubectl describe pods <span class="hljs-variable">$POD_NAME</span>       // å¯ä»¥çœ‹åˆ°labelå€¼å·²å˜ä¸ºapp=v1

$ kubectl delete service -l run=kubernetes-bootcamp // åˆ é™¤serviceï¼Œä½†appæœ¬èº«è¿˜æ˜¯åœ¨podsé‡Œç»§ç»­è·‘ç€çš„
</code></pre>
      <h2 id="%E6%B0%B4%E5%B9%B3%E6%8B%93%E5%B1%95%E5%BA%94%E7%94%A8">
        <a aria-hidden="true" class="anchor" href="#%E6%B0%B4%E5%B9%B3%E6%8B%93%E5%B1%95%E5%BA%94%E7%94%A8">
            <svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>
        </a>
        æ°´å¹³æ‹“å±•åº”ç”¨
      </h2>
    <p>æ°´å¹³å¢åŠ deploymentçš„æ•°é‡</p>
<p><img src="https://d33wubrfki0l68.cloudfront.net/30f75140a581110443397192d70a4cdb37df7bfc/b5f56/docs/tutorials/kubernetes-basics/public/images/module_05_scaling2.svg" alt=""/></p>
<p>æœ‰å…³å‘½ä»¤ï¼š</p>
<pre><code class="language-bash hljs">$ kubectl scale deployments/kubernetes-bootcamp --replicas=4    // æ‹“å±•replicasåˆ°å››ä¸ª
$ kubectl get pods -o wide  // æ˜¾ç¤ºpodsåŠip</code></pre>
      <h2 id="%E6%9B%B4%E6%96%B0%E5%BA%94%E7%94%A8">
        <a aria-hidden="true" class="anchor" href="#%E6%9B%B4%E6%96%B0%E5%BA%94%E7%94%A8">
            <svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>
        </a>
        æ›´æ–°åº”ç”¨
      </h2>
    <p>æ— å®•æœºåŠ¨æ€æ›´æ–°ï¼ŒåŒæ—¶ä¿ç•™ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ–¹ä¾¿å›æ»šã€‚</p>
<pre><code class="language-bash hljs">// é€šçŸ¥deploymentä½¿ç”¨æ–°çš„image
$ kubectl <span class="hljs-built_in">set</span> image deployments/kubernetes-bootcamp kubernetes-bootcamp=jocatalin/kubernetes-bootcamp:v2    
$ kubectl rollout status deployments/kubernetes-bootcamp    // æ˜¾ç¤ºrolloutçŠ¶æ€
$ kubectl get pods  // å¯ä»¥çœ‹åˆ°imageä¿¡æ¯å·²æ›´æ–°
$ kubectl rollout undo deployments/kubernetes-bootcamp  // è¿”å›ä¸Šä¸€ä¸ªç‰ˆæœ¬</code></pre><pre><code class="language-javascript hljs"><span class="hljs-keyword">const</span> searchParams = <span class="hljs-keyword">new</span> <span class="hljs-title function_">URLSearchParams</span>(location.<span class="hljs-property">search</span>);
<span class="hljs-keyword">const</span> title = searchParams.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;t&#x27;</span>);
<span class="hljs-keyword">const</span> year = searchParams.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;y&#x27;</span>);
<span class="hljs-keyword">if</span>(!title || !year) {
<span class="hljs-keyword">return</span> location.<span class="hljs-property">href</span> = <span class="hljs-string">&#x27;https://timi-wang.github.io&#x27;</span>;
}
<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;head title&#x27;</span>).<span class="hljs-property">innerText</span> = title.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;_&#x27;</span>).<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>).<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27; &#x27;</span>);</code></pre>
        </div>
        <footer id="article-footer">
        
            <a href=""></a>
        
        
            <a href=""></a>
        
        </footer>
    </article>
    <script src="https://utteranc.es/client.js"
            repo="timi-wang/timi-wang.github.io"
            issue-term="pathname"
            label="comment"
            theme="github-light"
            crossorigin="anonymous"
            async>
    </script>
</main>
</body>
</html>
